import postgres from "postgres";
import { drizzle } from "drizzle-orm/postgres-js";
import { walletPerformance } from "./packages/db/src/schema/index.ts";

const sql = postgres(process.env.DATABASE_URL || "postgresql://polybuddy:polybuddy@localhost:5432/polybuddy");
const db = drizzle(sql);

async function populateEliteTraders() {
  console.log("ğŸš€ Populating Elite Trader data...");

  const categories = ["Sports", "Entertainment", "Crypto", "Business", "Politics"];

  // Create 20 demo traders with varying scores
  const demoTraders = [
    // Elite Tier (5 traders)
    {
      walletAddress: "0x1111111111111111111111111111111111111111",
      totalProfit: "18500.00",
      totalVolume: "95000.00",
      winRate: "89.50",
      tradeCount: 150,
      roiPercent: "19.47",
      primaryCategory: "Crypto",
      lastTradeAt: new Date(),
      profitFactor: "4.85",
      sharpeRatio: "3.20",
      maxDrawdown: "8.30",
      consecutiveWins: 18,
      avgHoldingTime: 90, // 1.5 hours
      marketTimingScore: "95.00",
      riskAdjustedReturns: "4.20",
      riskProfile: "conservative",
      categoryDistribution: { Crypto: 75, Business: 25 },
      totalLoss: "4500.00",
      grossProfit: "23000.00",
      totalTrades: 150,
      winningTrades: 134,
      losingTrades: 16,
      averageProfitPerTrade: "171.64",
      averageLossPerTrade: "281.25",
      maxProfit: "1200.00",
      maxLoss: "-450.00",
      stdDevReturns: "0.12",
      eliteScore: "92.50",
      traderTier: "elite",
      rank: 1,
      eliteRank: 1,
    },
    {
      walletAddress: "0x2222222222222222222222222222222222222222",
      totalProfit: "16200.00",
      totalVolume: "78000.00",
      winRate: "86.20",
      tradeCount: 128,
      roiPercent: "20.77",
      primaryCategory: "Sports",
      lastTradeAt: new Date(),
      profitFactor: "4.32",
      sharpeRatio: "2.95",
      maxDrawdown: "9.80",
      consecutiveWins: 15,
      avgHoldingTime: 105,
      marketTimingScore: "91.50",
      riskAdjustedReturns: "3.85",
      riskProfile: "conservative",
      categoryDistribution: { Sports: 85, Entertainment: 15 },
      totalLoss: "4100.00",
      grossProfit: "20300.00",
      totalTrades: 128,
      winningTrades: 110,
      losingTrades: 18,
      averageProfitPerTrade: "184.55",
      averageLossPerTrade: "227.78",
      maxProfit: "1050.00",
      maxLoss: "-380.00",
      stdDevReturns: "0.14",
      eliteScore: "90.30",
      traderTier: "elite",
      rank: 2,
      eliteRank: 2,
    },
    {
      walletAddress: "0x3333333333333333333333333333333333333333",
      totalProfit: "14800.00",
      totalVolume: "72000.00",
      winRate: "84.10",
      tradeCount: 115,
      roiPercent: "20.56",
      primaryCategory: "Politics",
      lastTradeAt: new Date(),
      profitFactor: "3.95",
      sharpeRatio: "2.75",
      maxDrawdown: "11.20",
      consecutiveWins: 12,
      avgHoldingTime: 135,
      marketTimingScore: "88.00",
      riskAdjustedReturns: "3.50",
      riskProfile: "moderate",
      categoryDistribution: { Politics: 80, Business: 20 },
      totalLoss: "4200.00",
      grossProfit: "19000.00",
      totalTrades: 115,
      winningTrades: 97,
      losingTrades: 18,
      averageProfitPerTrade: "195.88",
      averageLossPerTrade: "233.33",
      maxProfit: "950.00",
      maxLoss: "-420.00",
      stdDevReturns: "0.16",
      eliteScore: "87.80",
      traderTier: "elite",
      rank: 3,
      eliteRank: 3,
    },
    {
      walletAddress: "0x4444444444444444444444444444444444444444",
      totalProfit: "13200.00",
      totalVolume: "68000.00",
      winRate: "82.50",
      tradeCount: 105,
      roiPercent: "19.41",
      primaryCategory: "Business",
      lastTradeAt: new Date(),
      profitFactor: "3.68",
      sharpeRatio: "2.55",
      maxDrawdown: "12.50",
      consecutiveWins: 11,
      avgHoldingTime: 150,
      marketTimingScore: "85.50",
      riskAdjustedReturns: "3.25",
      riskProfile: "moderate",
      categoryDistribution: { Business: 70, Crypto: 30 },
      totalLoss: "4300.00",
      grossProfit: "17500.00",
      totalTrades: 105,
      winningTrades: 87,
      losingTrades: 18,
      averageProfitPerTrade: "201.15",
      averageLossPerTrade: "238.89",
      maxProfit: "880.00",
      maxLoss: "-390.00",
      stdDevReturns: "0.17",
      eliteScore: "85.20",
      traderTier: "elite",
      rank: 4,
      eliteRank: 4,
    },
    {
      walletAddress: "0x5555555555555555555555555555555555555555",
      totalProfit: "11900.00",
      totalVolume: "62000.00",
      winRate: "81.30",
      tradeCount: 98,
      roiPercent: "19.19",
      primaryCategory: "Entertainment",
      lastTradeAt: new Date(),
      profitFactor: "3.42",
      sharpeRatio: "2.40",
      maxDrawdown: "13.80",
      consecutiveWins: 10,
      avgHoldingTime: 165,
      marketTimingScore: "82.00",
      riskAdjustedReturns: "3.00",
      riskProfile: "moderate",
      categoryDistribution: { Entertainment: 75, Sports: 25 },
      totalLoss: "4500.00",
      grossProfit: "16400.00",
      totalTrades: 98,
      winningTrades: 80,
      losingTrades: 18,
      averageProfitPerTrade: "205.00",
      averageLossPerTrade: "250.00",
      maxProfit: "820.00",
      maxLoss: "-410.00",
      stdDevReturns: "0.18",
      eliteScore: "82.60",
      traderTier: "elite",
      rank: 5,
      eliteRank: 5,
    },
    // Strong Tier (8 traders)
    {
      walletAddress: "0x6666666666666666666666666666666666666666",
      totalProfit: "9800.00",
      totalVolume: "55000.00",
      winRate: "76.40",
      tradeCount: 85,
      roiPercent: "17.82",
      primaryCategory: "Crypto",
      lastTradeAt: new Date(),
      profitFactor: "2.85",
      sharpeRatio: "2.10",
      maxDrawdown: "16.20",
      consecutiveWins: 8,
      avgHoldingTime: 180,
      marketTimingScore: "78.00",
      riskAdjustedReturns: "2.60",
      riskProfile: "moderate",
      categoryDistribution: { Crypto: 65, Politics: 35 },
      totalLoss: "5200.00",
      grossProfit: "15000.00",
      totalTrades: 85,
      winningTrades: 65,
      losingTrades: 20,
      averageProfitPerTrade: "230.77",
      averageLossPerTrade: "260.00",
      maxProfit: "750.00",
      maxLoss: "-480.00",
      stdDevReturns: "0.22",
      eliteScore: "76.80",
      traderTier: "strong",
      rank: 6,
    },
    {
      walletAddress: "0x7777777777777777777777777777777777777777",
      totalProfit: "8600.00",
      totalVolume: "50000.00",
      winRate: "74.20",
      tradeCount: 78,
      roiPercent: "17.20",
      primaryCategory: "Sports",
      lastTradeAt: new Date(),
      profitFactor: "2.65",
      sharpeRatio: "1.95",
      maxDrawdown: "17.50",
      consecutiveWins: 7,
      avgHoldingTime: 195,
      marketTimingScore: "74.50",
      riskAdjustedReturns: "2.40",
      riskProfile: "moderate",
      categoryDistribution: { Sports: 70, Entertainment: 30 },
      totalLoss: "5400.00",
      grossProfit: "14000.00",
      totalTrades: 78,
      winningTrades: 58,
      losingTrades: 20,
      averageProfitPerTrade: "241.38",
      averageLossPerTrade: "270.00",
      maxProfit: "680.00",
      maxLoss: "-520.00",
      stdDevReturns: "0.24",
      eliteScore: "73.50",
      traderTier: "strong",
      rank: 7,
    },
    {
      walletAddress: "0x8888888888888888888888888888888888888888",
      totalProfit: "7500.00",
      totalVolume: "46000.00",
      winRate: "72.80",
      tradeCount: 72,
      roiPercent: "16.30",
      primaryCategory: "Politics",
      lastTradeAt: new Date(),
      profitFactor: "2.48",
      sharpeRatio: "1.80",
      maxDrawdown: "18.80",
      consecutiveWins: 6,
      avgHoldingTime: 210,
      marketTimingScore: "71.00",
      riskAdjustedReturns: "2.20",
      riskProfile: "moderate",
      categoryDistribution: { Politics: 75, Business: 25 },
      totalLoss: "5600.00",
      grossProfit: "13100.00",
      totalTrades: 72,
      winningTrades: 52,
      losingTrades: 20,
      averageProfitPerTrade: "251.92",
      averageLossPerTrade: "280.00",
      maxProfit: "620.00",
      maxLoss: "-550.00",
      stdDevReturns: "0.26",
      eliteScore: "70.20",
      traderTier: "strong",
      rank: 8,
    },
    {
      walletAddress: "0x9999999999999999999999999999999999999999",
      totalProfit: "6800.00",
      totalVolume: "42000.00",
      winRate: "70.50",
      tradeCount: 65,
      roiPercent: "16.19",
      primaryCategory: "Business",
      lastTradeAt: new Date(),
      profitFactor: "2.32",
      sharpeRatio: "1.68",
      maxDrawdown: "20.10",
      consecutiveWins: 6,
      avgHoldingTime: 225,
      marketTimingScore: "68.50",
      riskAdjustedReturns: "2.05",
      riskProfile: "moderate",
      categoryDistribution: { Business: 60, Crypto: 40 },
      totalLoss: "5800.00",
      grossProfit: "12600.00",
      totalTrades: 65,
      winningTrades: 46,
      losingTrades: 19,
      averageProfitPerTrade: "273.91",
      averageLossPerTrade: "305.26",
      maxProfit: "580.00",
      maxLoss: "-580.00",
      stdDevReturns: "0.28",
      eliteScore: "67.80",
      traderTier: "strong",
      rank: 9,
    },
    {
      walletAddress: "0xAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
      totalProfit: "6200.00",
      totalVolume: "39000.00",
      winRate: "69.20",
      tradeCount: 60,
      roiPercent: "15.90",
      primaryCategory: "Entertainment",
      lastTradeAt: new Date(),
      profitFactor: "2.18",
      sharpeRatio: "1.55",
      maxDrawdown: "21.50",
      consecutiveWins: 5,
      avgHoldingTime: 240,
      marketTimingScore: "66.00",
      riskAdjustedReturns: "1.90",
      riskProfile: "moderate",
      categoryDistribution: { Entertainment: 70, Sports: 30 },
      totalLoss: "6000.00",
      grossProfit: "12200.00",
      totalTrades: 60,
      winningTrades: 42,
      losingTrades: 18,
      averageProfitPerTrade: "290.48",
      averageLossPerTrade: "333.33",
      maxProfit: "540.00",
      maxLoss: "-610.00",
      stdDevReturns: "0.30",
      eliteScore: "65.40",
      traderTier: "strong",
      rank: 10,
    },
    // More strong traders
    {
      walletAddress: "0xBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB",
      totalProfit: "5600.00",
      totalVolume: "36000.00",
      winRate: "67.80",
      tradeCount: 55,
      roiPercent: "15.56",
      primaryCategory: "Crypto",
      lastTradeAt: new Date(),
      profitFactor: "2.05",
      sharpeRatio: "1.42",
      maxDrawdown: "22.80",
      consecutiveWins: 5,
      avgHoldingTime: 255,
      marketTimingScore: "63.50",
      riskAdjustedReturns: "1.75",
      riskProfile: "aggressive",
      categoryDistribution: { Crypto: 80, Business: 20 },
      totalLoss: "6200.00",
      grossProfit: "11800.00",
      totalTrades: 55,
      winningTrades: 37,
      losingTrades: 18,
      averageProfitPerTrade: "318.92",
      averageLossPerTrade: "344.44",
      maxProfit: "510.00",
      maxLoss: "-640.00",
      stdDevReturns: "0.32",
      eliteScore: "63.20",
      traderTier: "strong",
      rank: 11,
    },
    {
      walletAddress: "0xCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC",
      totalProfit: "5100.00",
      totalVolume: "34000.00",
      winRate: "66.50",
      tradeCount: 52,
      roiPercent: "15.00",
      primaryCategory: "Sports",
      lastTradeAt: new Date(),
      profitFactor: "1.95",
      sharpeRatio: "1.32",
      maxDrawdown: "24.20",
      consecutiveWins: 4,
      avgHoldingTime: 270,
      marketTimingScore: "61.00",
      riskAdjustedReturns: "1.60",
      riskProfile: "aggressive",
      categoryDistribution: { Sports: 65, Politics: 35 },
      totalLoss: "6400.00",
      grossProfit: "11500.00",
      totalTrades: 52,
      winningTrades: 35,
      losingTrades: 17,
      averageProfitPerTrade: "328.57",
      averageLossPerTrade: "376.47",
      maxProfit: "480.00",
      maxLoss: "-670.00",
      stdDevReturns: "0.34",
      eliteScore: "61.50",
      traderTier: "strong",
      rank: 12,
    },
    {
      walletAddress: "0xDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD",
      totalProfit: "4700.00",
      totalVolume: "32000.00",
      winRate: "65.20",
      tradeCount: 48,
      roiPercent: "14.69",
      primaryCategory: "Politics",
      lastTradeAt: new Date(),
      profitFactor: "1.86",
      sharpeRatio: "1.25",
      maxDrawdown: "25.50",
      consecutiveWins: 4,
      avgHoldingTime: 285,
      marketTimingScore: "59.00",
      riskAdjustedReturns: "1.48",
      riskProfile: "aggressive",
      categoryDistribution: { Politics: 70, Entertainment: 30 },
      totalLoss: "6600.00",
      grossProfit: "11300.00",
      totalTrades: 48,
      winningTrades: 31,
      losingTrades: 17,
      averageProfitPerTrade: "364.52",
      averageLossPerTrade: "388.24",
      maxProfit: "460.00",
      maxLoss: "-690.00",
      stdDevReturns: "0.36",
      eliteScore: "60.10",
      traderTier: "strong",
      rank: 13,
    },
    // Moderate Tier (7 traders)
    {
      walletAddress: "0xEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE",
      totalProfit: "4200.00",
      totalVolume: "30000.00",
      winRate: "62.50",
      tradeCount: 45,
      roiPercent: "14.00",
      primaryCategory: "Business",
      lastTradeAt: new Date(),
      profitFactor: "1.68",
      sharpeRatio: "1.10",
      maxDrawdown: "27.80",
      consecutiveWins: 3,
      avgHoldingTime: 300,
      marketTimingScore: "55.00",
      riskAdjustedReturns: "1.30",
      riskProfile: "aggressive",
      categoryDistribution: { Business: 55, Crypto: 45 },
      totalLoss: "7000.00",
      grossProfit: "11200.00",
      totalTrades: 45,
      winningTrades: 28,
      losingTrades: 17,
      averageProfitPerTrade: "400.00",
      averageLossPerTrade: "411.76",
      maxProfit: "430.00",
      maxLoss: "-720.00",
      stdDevReturns: "0.38",
      eliteScore: "56.80",
      traderTier: "moderate",
      rank: 14,
    },
    {
      walletAddress: "0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF",
      totalProfit: "3800.00",
      totalVolume: "28000.00",
      winRate: "60.80",
      tradeCount: 42,
      roiPercent: "13.57",
      primaryCategory: "Entertainment",
      lastTradeAt: new Date(),
      profitFactor: "1.58",
      sharpeRatio: "1.02",
      maxDrawdown: "29.50",
      consecutiveWins: 3,
      avgHoldingTime: 315,
      marketTimingScore: "52.50",
      riskAdjustedReturns: "1.18",
      riskProfile: "aggressive",
      categoryDistribution: { Entertainment: 60, Sports: 40 },
      totalLoss: "7200.00",
      grossProfit: "11000.00",
      totalTrades: 42,
      winningTrades: 26,
      losingTrades: 16,
      averageProfitPerTrade: "423.08",
      averageLossPerTrade: "450.00",
      maxProfit: "400.00",
      maxLoss: "-750.00",
      stdDevReturns: "0.40",
      eliteScore: "54.20",
      traderTier: "moderate",
      rank: 15,
    },
    {
      walletAddress: "0x0000000000000000000000000000000000000001",
      totalProfit: "3400.00",
      totalVolume: "26000.00",
      winRate: "59.20",
      tradeCount: 38,
      roiPercent: "13.08",
      primaryCategory: "Crypto",
      lastTradeAt: new Date(),
      profitFactor: "1.48",
      sharpeRatio: "0.95",
      maxDrawdown: "31.20",
      consecutiveWins: 3,
      avgHoldingTime: 330,
      marketTimingScore: "50.00",
      riskAdjustedReturns: "1.05",
      riskProfile: "aggressive",
      categoryDistribution: { Crypto: 70, Politics: 30 },
      totalLoss: "7400.00",
      grossProfit: "10800.00",
      totalTrades: 38,
      winningTrades: 23,
      losingTrades: 15,
      averageProfitPerTrade: "469.57",
      averageLossPerTrade: "493.33",
      maxProfit: "380.00",
      maxLoss: "-780.00",
      stdDevReturns: "0.42",
      eliteScore: "51.90",
      traderTier: "moderate",
      rank: 16,
    },
    {
      walletAddress: "0x0000000000000000000000000000000000000002",
      totalProfit: "3000.00",
      totalVolume: "24000.00",
      winRate: "57.80",
      tradeCount: 35,
      roiPercent: "12.50",
      primaryCategory: "Sports",
      lastTradeAt: new Date(),
      profitFactor: "1.40",
      sharpeRatio: "0.88",
      maxDrawdown: "32.80",
      consecutiveWins: 2,
      avgHoldingTime: 345,
      marketTimingScore: "48.00",
      riskAdjustedReturns: "0.95",
      riskProfile: "aggressive",
      categoryDistribution: { Sports: 75, Entertainment: 25 },
      totalLoss: "7600.00",
      grossProfit: "10600.00",
      totalTrades: 35,
      winningTrades: 20,
      losingTrades: 15,
      averageProfitPerTrade: "530.00",
      averageLossPerTrade: "506.67",
      maxProfit: "360.00",
      maxLoss: "-810.00",
      stdDevReturns: "0.44",
      eliteScore: "49.80",
      traderTier: "moderate",
      rank: 17,
    },
    {
      walletAddress: "0x0000000000000000000000000000000000000003",
      totalProfit: "2600.00",
      totalVolume: "22000.00",
      winRate: "56.40",
      tradeCount: 32,
      roiPercent: "11.82",
      primaryCategory: "Politics",
      lastTradeAt: new Date(),
      profitFactor: "1.32",
      sharpeRatio: "0.82",
      maxDrawdown: "34.50",
      consecutiveWins: 2,
      avgHoldingTime: 360,
      marketTimingScore: "46.00",
      riskAdjustedReturns: "0.85",
      riskProfile: "aggressive",
      categoryDistribution: { Politics: 65, Business: 35 },
      totalLoss: "7800.00",
      grossProfit: "10400.00",
      totalTrades: 32,
      winningTrades: 18,
      losingTrades: 14,
      averageProfitPerTrade: "577.78",
      averageLossPerTrade: "557.14",
      maxProfit: "340.00",
      maxLoss: "-840.00",
      stdDevReturns: "0.46",
      eliteScore: "47.60",
      traderTier: "moderate",
      rank: 18,
    },
    {
      walletAddress: "0x0000000000000000000000000000000000000004",
      totalProfit: "2300.00",
      totalVolume: "20000.00",
      winRate: "55.00",
      tradeCount: 30,
      roiPercent: "11.50",
      primaryCategory: "Business",
      lastTradeAt: new Date(),
      profitFactor: "1.26",
      sharpeRatio: "0.75",
      maxDrawdown: "36.20",
      consecutiveWins: 2,
      avgHoldingTime: 375,
      marketTimingScore: "44.00",
      riskAdjustedReturns: "0.78",
      riskProfile: "aggressive",
      categoryDistribution: { Business: 60, Crypto: 40 },
      totalLoss: "8000.00",
      grossProfit: "10300.00",
      totalTrades: 30,
      winningTrades: 17,
      losingTrades: 13,
      averageProfitPerTrade: "605.88",
      averageLossPerTrade: "615.38",
      maxProfit: "320.00",
      maxLoss: "-870.00",
      stdDevReturns: "0.48",
      eliteScore: "45.50",
      traderTier: "moderate",
      rank: 19,
    },
    {
      walletAddress: "0x0000000000000000000000000000000000000005",
      totalProfit: "2000.00",
      totalVolume: "18000.00",
      winRate: "53.60",
      tradeCount: 28,
      roiPercent: "11.11",
      primaryCategory: "Entertainment",
      lastTradeAt: new Date(),
      profitFactor: "1.20",
      sharpeRatio: "0.70",
      maxDrawdown: "38.00",
      consecutiveWins: 2,
      avgHoldingTime: 390,
      marketTimingScore: "42.00",
      riskAdjustedReturns: "0.70",
      riskProfile: "aggressive",
      categoryDistribution: { Entertainment: 55, Sports: 45 },
      totalLoss: "8200.00",
      grossProfit: "10200.00",
      totalTrades: 28,
      winningTrades: 15,
      losingTrades: 13,
      averageProfitPerTrade: "680.00",
      averageLossPerTrade: "630.77",
      maxProfit: "300.00",
      maxLoss: "-900.00",
      stdDevReturns: "0.50",
      eliteScore: "43.80",
      traderTier: "moderate",
      rank: 20,
    },
  ];

  console.log(`ğŸ“ Preparing to insert ${demoTraders.length} traders...`);

  for (const trader of demoTraders) {
    try {
      await db
        .insert(walletPerformance)
        .values(trader)
        .onConflictDoUpdate({
          target: walletPerformance.walletAddress,
          set: trader,
        });
    } catch (error) {
      console.error(`Failed to insert trader ${trader.walletAddress}:`, error);
    }
  }

  console.log(`âœ… Successfully populated ${demoTraders.length} elite traders`);

  // Calculate and display statistics
  const eliteCount = demoTraders.filter((t) => t.traderTier === "elite").length;
  const strongCount = demoTraders.filter((t) => t.traderTier === "strong").length;
  const moderateCount = demoTraders.filter((t) => t.traderTier === "moderate").length;
  const avgScore =
    demoTraders.reduce((sum, t) => sum + parseFloat(t.eliteScore), 0) / demoTraders.length;

  console.log("\nğŸ“Š Elite Trader Statistics:");
  console.log(`   Total Traders: ${demoTraders.length}`);
  console.log(`   ğŸ† Elite Tier (80+): ${eliteCount}`);
  console.log(`   ğŸ’ª Strong Tier (60-79): ${strongCount}`);
  console.log(`   ğŸ“ˆ Moderate Tier (40-59): ${moderateCount}`);
  console.log(`   Average Score: ${avgScore.toFixed(2)}`);
  console.log(`   Top Score: ${demoTraders[0].eliteScore}`);
  console.log(`   Lowest Score: ${demoTraders[demoTraders.length - 1].eliteScore}`);

  console.log("\nğŸ‰ Elite trader data population complete!");
  await sql.end();
  process.exit(0);
}

populateEliteTraders().catch((err) => {
  console.error("âŒ Error:", err);
  process.exit(1);
});
